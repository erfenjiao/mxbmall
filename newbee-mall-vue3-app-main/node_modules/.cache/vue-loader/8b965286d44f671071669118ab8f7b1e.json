{"remainingRequest":"/home/erfenjiao/web/springboot+vue商城前后端分离+后台管理/newbee-mall-vue3-app-main/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/home/erfenjiao/web/springboot+vue商城前后端分离+后台管理/newbee-mall-vue3-app-main/src/views/AddressEdit.vue?vue&type=template&id=67123cd4","dependencies":[{"path":"/home/erfenjiao/web/springboot+vue商城前后端分离+后台管理/newbee-mall-vue3-app-main/src/views/AddressEdit.vue","mtime":1663211991402},{"path":"/home/erfenjiao/web/springboot+vue商城前后端分离+后台管理/newbee-mall-vue3-app-main/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/erfenjiao/web/springboot+vue商城前后端分离+后台管理/newbee-mall-vue3-app-main/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/home/erfenjiao/web/springboot+vue商城前后端分离+后台管理/newbee-mall-vue3-app-main/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":499162500000},{"path":"/home/erfenjiao/web/springboot+vue商城前后端分离+后台管理/newbee-mall-vue3-app-main/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/erfenjiao/web/springboot+vue商城前后端分离+后台管理/newbee-mall-vue3-app-main/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgPGRpdiBjbGFzcz0iYWRkcmVzcy1lZGl0LWJveCI+CiAgICA8cy1oZWFkZXIgOm5hbWU9ImAke3R5cGUgPT0gJ2FkZCcgPyAn5paw5aKe5Zyw5Z2AJyA6ICfnvJbovpHlnLDlnYAnfWAiPjwvcy1oZWFkZXI+CiAgICA8dmFuLWFkZHJlc3MtZWRpdAogICAgICBjbGFzcz0iZWRpdCIKICAgICAgOmFyZWEtbGlzdD0iYXJlYUxpc3QiCiAgICAgIDphZGRyZXNzLWluZm89ImFkZHJlc3NJbmZvIgogICAgICA6c2hvdy1kZWxldGU9InR5cGUgPT0gJ2VkaXQnIgogICAgICBzaG93LXNldC1kZWZhdWx0CiAgICAgIHNob3ctc2VhcmNoLXJlc3VsdAogICAgICA6c2VhcmNoLXJlc3VsdD0ic2VhcmNoUmVzdWx0IgogICAgICA6YXJlYS1jb2x1bW5zLXBsYWNlaG9sZGVyPSJbJ+ivt+mAieaLqScsICfor7fpgInmi6knLCAn6K+36YCJ5oupJ10iCiAgICAgIEBzYXZlPSJvblNhdmUiCiAgICAgIEBkZWxldGU9Im9uRGVsZXRlIgogICAgLz4KICA8L2Rpdj4K"},{"version":3,"sources":["/home/erfenjiao/web/springboot+vue商城前后端分离+后台管理/newbee-mall-vue3-app-main/src/views/AddressEdit.vue"],"names":[],"mappings":";EAME,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACjE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACpB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAC1B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAC5B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACjB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAC5B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAChD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACnB,CAAC;EACH,CAAC,CAAC,CAAC,CAAC,CAAC","file":"/home/erfenjiao/web/springboot+vue商城前后端分离+后台管理/newbee-mall-vue3-app-main/src/views/AddressEdit.vue","sourceRoot":"","sourcesContent":["<!--\n\n *\n-->\n\n<template>\n  <div class=\"address-edit-box\">\n    <s-header :name=\"`${type == 'add' ? '新增地址' : '编辑地址'}`\"></s-header>\n    <van-address-edit\n      class=\"edit\"\n      :area-list=\"areaList\"\n      :address-info=\"addressInfo\"\n      :show-delete=\"type == 'edit'\"\n      show-set-default\n      show-search-result\n      :search-result=\"searchResult\"\n      :area-columns-placeholder=\"['请选择', '请选择', '请选择']\"\n      @save=\"onSave\"\n      @delete=\"onDelete\"\n    />\n  </div>\n</template>\n\n<script>\nimport { reactive, onMounted, toRefs } from 'vue'\nimport { Toast } from 'vant'\nimport sHeader from '@/components/SimpleHeader'\nimport { addAddress, EditAddress, DeleteAddress, getAddressDetail } from '@/service/address'\nimport { tdist } from '@/common/js/utils'\nimport { useRoute, useRouter } from 'vue-router'\nexport default {\n  components: {\n    sHeader\n  },\n  setup() {\n    const route = useRoute()\n    const router = useRouter()\n    const state = reactive({\n      areaList: {\n        province_list: {},\n        city_list: {},\n        county_list: {}\n      },\n      searchResult: [],\n      type: 'add',\n      addressId: '',\n      addressInfo: {},\n      from: route.query.from\n    })\n\n    onMounted(async () => {\n      // 省市区列表构造\n      let _province_list = {}\n      let _city_list = {}\n      let _county_list = {}\n      tdist.getLev1().forEach(p => {\n        _province_list[p.id] = p.text\n        tdist.getLev2(p.id).forEach(c => {\n          _city_list[c.id] = c.text\n          tdist.getLev3(c.id).forEach(q => _county_list[q.id] = q.text)\n        })\n      })\n      state.areaList.province_list = _province_list\n      state.areaList.city_list = _city_list\n      state.areaList.county_list = _county_list\n\n      const { addressId, type, from } = route.query\n      state.addressId = addressId\n      state.type = type\n      state.from = from || ''\n      if (type == 'edit') {\n        const { data: addressDetail } = await getAddressDetail(addressId)\n        let _areaCode = ''\n        const province = tdist.getLev1()\n        Object.entries(state.areaList.county_list).forEach(([id, text]) => {\n          // 先找出当前对应的区\n          if (text == addressDetail.regionName) {\n            // 找到区对应的几个省份\n            const provinceIndex = province.findIndex(item => item.id.substr(0, 2) == id.substr(0, 2))\n            // 找到区对应的几个市区\n            // eslint-disable-next-line no-unused-vars\n            const cityItem = Object.entries(state.areaList.city_list).filter(([cityId, cityName]) => cityId.substr(0, 4) == id.substr(0, 4))[0]\n            // 对比找到的省份和接口返回的省份是否相等，因为有一些区会重名\n            if (province[provinceIndex].text == addressDetail.provinceName && cityItem[1] == addressDetail.cityName) {\n              _areaCode = id\n            }\n          }\n        })\n        state.addressInfo = {\n          id: addressDetail.addressId,\n          name: addressDetail.userName,\n          tel: addressDetail.userPhone,\n          province: addressDetail.provinceName,\n          city: addressDetail.cityName,\n          county: addressDetail.regionName,\n          addressDetail: addressDetail.detailAddress,\n          areaCode: _areaCode,\n          isDefault: !!addressDetail.defaultFlag\n        }\n      }\n    })\n\n    const onSave = async (content) => {\n      const params = {\n        userName: content.name,\n        userPhone: content.tel,\n        provinceName: content.province,\n        cityName: content.city,\n        regionName: content.county,\n        detailAddress: content.addressDetail,\n        defaultFlag: content.isDefault ? 1 : 0,\n      }\n      if (state.type == 'edit') {\n        params['addressId'] = state.addressId\n      }\n      await state.type == 'add' ? addAddress(params) : EditAddress(params)\n      Toast('保存成功')\n      setTimeout(() => {\n        router.back()\n      }, 1000)\n    }\n\n    const onDelete = async () => {\n      await DeleteAddress(state.addressId)\n      Toast('删除成功')\n      setTimeout(() => {\n        router.back()\n      }, 1000)\n    }\n\n    return {\n      ...toRefs(state),\n      onSave,\n      onDelete\n    }\n  }\n}\n</script>\n\n<style lang=\"less\">\n  @import '../common/style/mixin';\n  .edit {\n    .van-field__body {\n      textarea {\n        height: 26px!important;\n      }\n    }\n  }\n  .address-edit-box {\n    .van-address-edit {\n      .van-button--danger {\n        background: @primary;\n        border-color: @primary;\n      }\n      .van-switch--on {\n        background: @primary;\n      }\n    }\n  }\n</style>\n"]}]}