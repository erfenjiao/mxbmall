{"remainingRequest":"/home/erfenjiao/mxbmall/newbee-mall-vue3-app-main/node_modules/babel-loader/lib/index.js!/home/erfenjiao/mxbmall/newbee-mall-vue3-app-main/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/erfenjiao/mxbmall/newbee-mall-vue3-app-main/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/home/erfenjiao/mxbmall/newbee-mall-vue3-app-main/src/views/Login.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/erfenjiao/mxbmall/newbee-mall-vue3-app-main/src/views/Login.vue","mtime":1671008419639},{"path":"/home/erfenjiao/mxbmall/newbee-mall-vue3-app-main/babel.config.js","mtime":1671008419639},{"path":"/home/erfenjiao/mxbmall/newbee-mall-vue3-app-main/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/erfenjiao/mxbmall/newbee-mall-vue3-app-main/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/home/erfenjiao/mxbmall/newbee-mall-vue3-app-main/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/erfenjiao/mxbmall/newbee-mall-vue3-app-main/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJ2YW50L2VzL3RvYXN0L3N0eWxlIjsKaW1wb3J0IF9Ub2FzdCBmcm9tICJ2YW50L2VzL3RvYXN0IjsKaW1wb3J0IHsgcmVhY3RpdmUsIHJlZiwgdG9SZWZzIH0gZnJvbSAndnVlJzsKaW1wb3J0IHNIZWFkZXIgZnJvbSAnQC9jb21wb25lbnRzL1NpbXBsZUhlYWRlcic7CmltcG9ydCB2dWVJbWdWZXJpZnkgZnJvbSAnQC9jb21wb25lbnRzL1Z1ZUltYWdlVmVyaWZ5JzsKaW1wb3J0IHsgbG9naW4sIHJlZ2lzdGVyIH0gZnJvbSAnQC9zZXJ2aWNlL3VzZXInOwppbXBvcnQgeyBzZXRMb2NhbCB9IGZyb20gJ0AvY29tbW9uL2pzL3V0aWxzJzsKaW1wb3J0IG1kNSBmcm9tICdqcy1tZDUnOwpleHBvcnQgZGVmYXVsdCB7CiAgc2V0dXAoKSB7CiAgICBjb25zdCB2ZXJpZnlSZWYgPSByZWYobnVsbCk7CiAgICBjb25zdCBzdGF0ZSA9IHJlYWN0aXZlKHsKICAgICAgdXNlcm5hbWU6ICcnLAogICAgICBwYXNzd29yZDogJycsCiAgICAgIHVzZXJuYW1lMTogJycsCiAgICAgIHBhc3N3b3JkMTogJycsCiAgICAgIHR5cGU6ICdsb2dpbicsCiAgICAgIGltZ0NvZGU6ICcnLAogICAgICB2ZXJpZnk6ICcnCiAgICB9KTsKCiAgICAvLyDliIfmjaLnmbvlvZXlkozms6jlhozkuKTnp43mqKHlvI8KICAgIGNvbnN0IHRvZ2dsZSA9IHYgPT4gewogICAgICBzdGF0ZS50eXBlID0gdjsKICAgICAgc3RhdGUudmVyaWZ5ID0gJyc7CiAgICB9OwoKICAgIC8vIOaPkOS6pOeZu+W9leaIluazqOWGjOihqOWNlQogICAgY29uc3Qgb25TdWJtaXQgPSBhc3luYyB2YWx1ZXMgPT4gewogICAgICBjb25zb2xlLmxvZygndmVyaWZ5UmVmLnZhbHVlLmltZ0NvZGUnLCB2ZXJpZnlSZWYudmFsdWUuaW1nQ29kZSk7CiAgICAgIHN0YXRlLmltZ0NvZGUgPSB2ZXJpZnlSZWYudmFsdWUuaW1nQ29kZSB8fCAnJzsKICAgICAgaWYgKHN0YXRlLnZlcmlmeS50b0xvd2VyQ2FzZSgpICE9IHN0YXRlLmltZ0NvZGUudG9Mb3dlckNhc2UoKSkgewogICAgICAgIF9Ub2FzdC5mYWlsKCfpqozor4HnoIHmnInor68nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHN0YXRlLnR5cGUgPT0gJ2xvZ2luJykgewogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGRhdGEKICAgICAgICB9ID0gYXdhaXQgbG9naW4oewogICAgICAgICAgImxvZ2luTmFtZSI6IHZhbHVlcy51c2VybmFtZSwKICAgICAgICAgICJwYXNzd29yZE1kNSI6IG1kNSh2YWx1ZXMucGFzc3dvcmQpCiAgICAgICAgfSk7CiAgICAgICAgc2V0TG9jYWwoJ3Rva2VuJywgZGF0YSk7CiAgICAgICAgLy8g6ZyA6KaB5Yi35paw6aG16Z2i77yM5ZCm5YiZIGF4aW9zLmpzIOaWh+S7tumHjOeahCB0b2tlbiDkuI3kvJrooqvph43nva4KICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvJzsKICAgICAgfSBlbHNlIHsKICAgICAgICBhd2FpdCByZWdpc3Rlcih7CiAgICAgICAgICAibG9naW5OYW1lIjogdmFsdWVzLnVzZXJuYW1lMSwKICAgICAgICAgICJwYXNzd29yZCI6IHZhbHVlcy5wYXNzd29yZDEKICAgICAgICB9KTsKICAgICAgICBfVG9hc3Quc3VjY2Vzcygn5rOo5YaM5oiQ5YqfJyk7CiAgICAgICAgc3RhdGUudHlwZSA9ICdsb2dpbic7CiAgICAgICAgc3RhdGUudmVyaWZ5ID0gJyc7CiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gewogICAgICAuLi50b1JlZnMoc3RhdGUpLAogICAgICB0b2dnbGUsCiAgICAgIG9uU3VibWl0LAogICAgICB2ZXJpZnlSZWYKICAgIH07CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBzSGVhZGVyLAogICAgdnVlSW1nVmVyaWZ5CiAgfQp9Ow=="},{"version":3,"mappings":";;AAiFA,SAASA,QAAQ,EAAEC,GAAG,EAAEC,MAAK,QAAS,KAAI;AAC1C,OAAOC,OAAM,MAAO,2BAA0B;AAC9C,OAAOC,YAAW,MAAO,6BAA4B;AACrD,SAASC,KAAK,EAAEC,QAAO,QAAS,gBAAe;AAC/C,SAASC,QAAO,QAAS,mBAAkB;AAC3C,OAAOC,GAAE,MAAO,QAAO;AAEvB,eAAe;EACbC,KAAK,GAAG;IACN,MAAMC,SAAQ,GAAIT,GAAG,CAAC,IAAI;IAC1B,MAAMU,KAAI,GAAIX,QAAQ,CAAC;MACrBY,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE,EAAE;MACZC,SAAS,EAAE,EAAE;MACbC,SAAS,EAAE,EAAE;MACbC,IAAI,EAAE,OAAO;MACbC,OAAO,EAAE,EAAE;MACXC,MAAM,EAAE;IACV,CAAC;;IAED;IACA,MAAMC,MAAK,GAAKC,CAAC,IAAK;MACpBT,KAAK,CAACK,IAAG,GAAII;MACbT,KAAK,CAACO,MAAK,GAAI,EAAC;IAClB;;IAEA;IACA,MAAMG,QAAO,GAAI,MAAOC,MAAM,IAAK;MACjCC,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAEd,SAAS,CAACe,KAAK,CAACR,OAAO;MAC9DN,KAAK,CAACM,OAAM,GAAIP,SAAS,CAACe,KAAK,CAACR,OAAM,IAAK,EAAC;MAC5C,IAAIN,KAAK,CAACO,MAAM,CAACQ,WAAW,EAAC,IAAKf,KAAK,CAACM,OAAO,CAACS,WAAW,EAAE,EAAE;QAC7D,OAAMC,IAAI,CAAC,OAAO;QAClB;MACF;MACA,IAAIhB,KAAK,CAACK,IAAG,IAAK,OAAO,EAAE;QACzB,MAAM;UAAEY;QAAK,IAAI,MAAMvB,KAAK,CAAC;UAC3B,WAAW,EAAEiB,MAAM,CAACV,QAAQ;UAC5B,aAAa,EAAEJ,GAAG,CAACc,MAAM,CAACT,QAAQ;QACpC,CAAC;QACDN,QAAQ,CAAC,OAAO,EAAEqB,IAAI;QACtB;QACAC,MAAM,CAACC,QAAQ,CAACC,IAAG,GAAI,GAAE;MAC3B,OAAO;QACL,MAAMzB,QAAQ,CAAC;UACb,WAAW,EAAEgB,MAAM,CAACR,SAAS;UAC7B,UAAU,EAAEQ,MAAM,CAACP;QACrB,CAAC;QACD,OAAMiB,OAAO,CAAC,MAAM;QACpBrB,KAAK,CAACK,IAAG,GAAI,OAAM;QACnBL,KAAK,CAACO,MAAK,GAAI,EAAC;MAClB;IACF;IAEA,OAAO;MACL,GAAGhB,MAAM,CAACS,KAAK,CAAC;MAChBQ,MAAM;MACNE,QAAQ;MACRX;IACF;EACF,CAAC;EACDuB,UAAU,EAAE;IACV9B,OAAO;IACPC;EACF;AACF","names":["reactive","ref","toRefs","sHeader","vueImgVerify","login","register","setLocal","md5","setup","verifyRef","state","username","password","username1","password1","type","imgCode","verify","toggle","v","onSubmit","values","console","log","value","toLowerCase","fail","data","window","location","href","success","components"],"sourceRoot":"","sources":["/home/erfenjiao/mxbmall/newbee-mall-vue3-app-main/src/views/Login.vue"],"sourcesContent":["<!--\n\n *\n-->\n\n<template>\n  <div class=\"login\">\n    <s-header :name=\"type == 'login' ? '登录' : '注册'\" :back=\"'/home'\"></s-header>\n    <img class=\"logo\" src=\"https://s.yezgea02.com/1604045825972/newbee-mall-vue3-app-logo.png\" alt=\"\">\n    <div v-if=\"type == 'login'\" class=\"login-body login\">\n      <van-form @submit=\"onSubmit\">\n        <van-field\n          v-model=\"username\"\n          name=\"username\"\n          label=\"用户名\"\n          placeholder=\"用户名\"\n          :rules=\"[{ required: true, message: '---请填写用户名---' }]\"\n        />\n        <van-field\n          v-model=\"password\"\n          type=\"password\"\n          name=\"password\"\n          label=\"密码\"\n          placeholder=\"密码\"\n          :rules=\"[{ required: true, message: '---请填写密码---' }]\"\n        />\n        <van-field\n          center\n          clearable\n          label=\"验证码\"\n          placeholder=\"输入验证码\"\n          v-model=\"verify\"\n        >\n          <template #button>\n            <vue-img-verify ref=\"verifyRef\" />\n          </template>\n        </van-field>\n        <div style=\"margin: 16px;\">\n          <div class=\"link-register\" @click=\"toggle('register')\">立即注册</div>\n          <van-button round block color=\"#1baeae\" native-type=\"submit\">登录</van-button>\n        </div>\n      </van-form>\n    </div>\n    <div v-else class=\"login-body register\">\n      <van-form @submit=\"onSubmit\">\n        <van-field\n          v-model=\"username1\"\n          name=\"username1\"\n          label=\"用户名\"\n          placeholder=\"用户名\"\n          :rules=\"[{ required: true, message: '---请填写用户名' }]\"\n        />\n        <van-field\n          v-model=\"password1\"\n          type=\"password\"\n          name=\"password1\"\n          label=\"密码\"\n          placeholder=\"密码\"\n          :rules=\"[{ required: true, message: '---请填写密码' }]\"\n        />\n        <van-field\n          center\n          clearable\n          label=\"验证码\"\n          placeholder=\"输入验证码\"\n          v-model=\"verify\"\n        >\n          <template #button>\n            <vue-img-verify ref=\"verifyRef\" />\n          </template>\n        </van-field>\n        <div style=\"margin: 16px;\">\n           <div class=\"link-login\" @click=\"toggle('login')\">已有登录账号</div>\n          <van-button round block color=\"#1baeae\" native-type=\"submit\">注册</van-button>\n        </div>\n      </van-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { reactive, ref, toRefs } from 'vue'\nimport sHeader from '@/components/SimpleHeader'\nimport vueImgVerify from '@/components/VueImageVerify'\nimport { login, register } from '@/service/user'\nimport { setLocal } from '@/common/js/utils'\nimport md5 from 'js-md5'\nimport { Toast } from 'vant'\nexport default {\n  setup() {\n    const verifyRef = ref(null)\n    const state = reactive({\n      username: '',\n      password: '',\n      username1: '',\n      password1: '',\n      type: 'login',\n      imgCode: '',\n      verify: ''\n    })\n\n    // 切换登录和注册两种模式\n    const toggle = (v) => {\n      state.type = v\n      state.verify = ''\n    }\n\n    // 提交登录或注册表单\n    const onSubmit = async (values) => {\n      console.log('verifyRef.value.imgCode', verifyRef.value.imgCode)\n      state.imgCode = verifyRef.value.imgCode || ''\n      if (state.verify.toLowerCase() != state.imgCode.toLowerCase()) {\n        Toast.fail('验证码有误')\n        return\n      }\n      if (state.type == 'login') {\n        const { data } = await login({\n          \"loginName\": values.username,\n          \"passwordMd5\": md5(values.password)\n        })\n        setLocal('token', data)\n        // 需要刷新页面，否则 axios.js 文件里的 token 不会被重置\n        window.location.href = '/'\n      } else {\n        await register({\n          \"loginName\": values.username1,\n          \"password\": values.password1\n        })\n        Toast.success('注册成功')\n        state.type = 'login'\n        state.verify = ''\n      }\n    }\n\n    return {\n      ...toRefs(state),\n      toggle,\n      onSubmit,\n      verifyRef\n    }\n  },\n  components: {\n    sHeader,\n    vueImgVerify\n  }\n}\n</script>\n\n<style lang=\"less\">\n  .login {\n    .logo {\n      width: 120px;\n      height: 120px;\n      display: block;\n      margin: 80px auto 20px;\n    }\n    .login-body {\n      padding: 0 20px;\n    }\n    .login {\n      .link-register {\n        font-size: 14px;\n        margin-bottom: 20px;\n        color: #0a2847;\n        display: inline-block;\n      }\n    }\n    .register {\n      .link-login {\n        font-size: 14px;\n        margin-bottom: 20px;\n        color: #092c4f;\n        display: inline-block;\n      }\n    }\n    .verify-bar-area {\n      margin-top: 24px;\n      .verify-left-bar {\n        border-color: #084343;\n      }\n      .verify-move-block {\n        background-color: #207474;\n        color: #d87777;\n      }\n    }\n    .verify {\n      >div {\n        width: 100%;\n      }\n      display: flex;\n      justify-content: center;\n      .cerify-code-panel {\n        margin-top: 16px;\n      }\n      .verify-code {\n        width: 40%!important;\n        float: left!important;\n      }\n      .verify-code-area {\n        float: left!important;\n        width: 54%!important;\n        margin-left: 14px!important;\n        .varify-input-code {\n          width: 90px;\n          height: 38px!important;\n          border: 1px solid #8d2d2d;\n          padding-left: 10px;\n          font-size: 16px;\n        }\n        .verify-change-area {\n          line-height: 44px;\n        }\n      }\n    }\n  }\n</style>\n"]}]}